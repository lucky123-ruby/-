use std::collections::HashSet;
use std::process;
use sysinfo::{Pid, System};
use log::{info, warn};

#[cfg(windows)]
use windows::Win32::Foundation::CloseHandle;
#[cfg(windows)]
use windows::Win32::System::Threading::{OpenProcess, TerminateProcess, PROCESS_TERMINATE};

pub struct ProcessKiller {
    target_processes: HashSet<String>,
    protected_processes: HashSet<String>,
}

impl ProcessKiller {
    pub fn new() -> Self {
        let mut target_processes = HashSet::new();
        let mut protected_processes = HashSet::new();

        protected_processes.extend(vec![
            "system".to_string(),
            "system idle process".to_string(),
            "registry".to_string(),
            "smss".to_string(),
            "csrss".to_string(),
            "wininit".to_string(),
            "winlogon".to_string(),
            "services".to_string(),
            "lsass".to_string(),
            "lsm".to_string(),
            "svchost".to_string(),
            "explorer".to_string(),
            "dwm".to_string(),
            "conhost".to_string(),
            "rundll32".to_string(),
            "taskmgr".to_string(),
            "w3wp".to_string(),
            "iisexpress".to_string(),
            "cmd".to_string(),
            "powershell".to_string(),
            "pwsh".to_string(),
            "dllhost".to_string(),
            "msdtc".to_string(),
            "spoolsv".to_string(),
            "audiodg".to_string(),
            "searchindexer".to_string(),
            "searchprotocolhost".to_string(),
            "searchfilterhost".to_string(),
            "wlidsvc".to_string(),
            "wlidsvcm".to_string(),
            "wlidsvc".to_string(),
            "appinfo".to_string(),
            "appvshnotify".to_string(),
            "appreadiness".to_string(),
            "appxdeploymentclient".to_string(),
            "appxpackagingsvc".to_string(),
            "audiosrv".to_string(),
            "bfe".to_string(),
            "bits".to_string(),
            "browser".to_string(),
            "cdpsvc".to_string(),
            "certpropservice".to_string(),
            "clippsv".to_string(),
            "coremessaging".to_string(),
            "cryptsvc".to_string(),
            "cscript".to_string(),
            "dasHost".to_string(),
            "dfsr".to_string(),
            "dhcp".to_string(),
            "diagsvc".to_string(),
            "diagnosticshub.standardcollector.service".to_string(),
            "displayenhancementservice".to_string(),
            "dot3svc".to_string(),
            "dps".to_string(),
            "dusmsvc".to_string(),
            "eapsvc".to_string(),
            "embeddedmode".to_string(),
            "eventlog".to_string(),
            "faxsvc".to_string(),
            "fdphost".to_string(),
            "fdrespub".to_string(),
            "gpsvc".to_string(),
            "hidserv".to_string(),
            "hkcmd".to_string(),
            "igfxpers".to_string(),
            "igfxtray".to_string(),
            "ikeext".to_string(),
            "iphlpsvc".to_string(),
            "keyiso".to_string(),
            "ksecdd".to_string(),
            "lanmanserver".to_string(),
            "lanmanworkstation".to_string(),
            "lmhosts".to_string(),
            "mpssvc".to_string(),
            "msdtc".to_string(),
            "msgsvc".to_string(),
            "msiserver".to_string(),
            "netprofm".to_string(),
            "nettcpportsharing".to_string(),
            "p2psvc".to_string(),
            "pcaevtsvc".to_string(),
            "pla".to_string(),
            "plaaservice".to_string(),
            "policyagent".to_string(),
            "profsvc".to_string(),
            "qwave".to_string(),
            "rasauto".to_string(),
            "rasman".to_string(),
            "rpcss".to_string(),
            "rpcrt4".to_string(),
            "samsrv".to_string(),
            "schedule".to_string(),
            "seclogon".to_string(),
            "sens".to_string(),
            "sessionenv".to_string(),
            "shellhwdetection".to_string(),
            "smphost".to_string(),
            "sppsvc".to_string(),
            "ssh-agent".to_string(),
            "sspisrv".to_string(),
            "stisvc".to_string(),
            "swprv".to_string(),
            "sysmain".to_string(),
            "tapisrv".to_string(),
            "themeservice".to_string(),
            "threadorder".to_string(),
            "trkwks".to_string(),
            "ui0detect".to_string(),
            "umrdpservice".to_string(),
            "upnphost".to_string(),
            "vds".to_string(),
            "vmms".to_string(),
            "vmwp".to_string(),
            "vss".to_string(),
            "w32time".to_string(),
            "wbengine".to_string(),
            "wbiosrvc".to_string(),
            "wcncsvc".to_string(),
            "webclient".to_string(),
            "webengine".to_string(),
            "werfault".to_string(),
            "werfaultsecure".to_string(),
            "wiaservc".to_string(),
            "winmgmt".to_string(),
            "winrm".to_string(),
            "winsrv".to_string(),
            "wlanext".to_string(),
            "wlansvc".to_string(),
            "wmiapsrv".to_string(),
            "wmiprvse".to_string(),
            "wmiutils".to_string(),
            "wpdshextautoplayplayer".to_string(),
            "wpdshserviceobj".to_string(),
            "wscsvc".to_string(),
            "wsearch".to_string(),
            "wuauserv".to_string(),
            "wudfsvc".to_string(),
            "wusa".to_string(),
        ]);

        target_processes.extend(vec![
            "vmware".to_string(),
            "vmware-vmx".to_string(),
            "vmware-remotemks".to_string(),
            "vmware-authd".to_string(),
            "vmware-usbarbitrator".to_string(),
            "vmware-tray".to_string(),
            "vmware-hostd".to_string(),
            "vmware-natd".to_string(),
            "vmware-dhcpd".to_string(),
            "vmware-vdiskmanager".to_string(),
            "vmware-user".to_string(),
            "vmware-unity-helper".to_string(),
            "vmware-vmware-vmx".to_string(),
            "vmware-vcenter".to_string(),
            "vmware-vcsa".to_string(),
            "virtualbox".to_string(),
            "virtualboxvm".to_string(),
            "vboxheadless".to_string(),
            "vboxmanage".to_string(),
            "vboxwebsrv".to_string(),
            "vboxballoonctrl".to_string(),
            "vboxautostart".to_string(),
            "vboxsvc".to_string(),
            "vboxxpcom".to_string(),
            "vboxnetdhcp".to_string(),
            "vboxnetadp".to_string(),
            "vboxnetflt".to_string(),
            "vboxdrvu".to_string(),
            "vboxusb".to_string(),
            "vboxsh".to_string(),
            "vboxbfe".to_string(),
            "vboximg-mount".to_string(),
            "vboxsdl".to_string(),
            "vboxrt".to_string(),
            "hyper-v".to_string(),
            "vmms".to_string(),
            "vmwp".to_string(),
            "vmmms".to_string(),
            "winword".to_string(),
            "excel".to_string(),
            "powerpnt".to_string(),
            "msaccess".to_string(),
            "outlook".to_string(),
            "onenote".to_string(),
            "publisher".to_string(),
            "visio".to_string(),
            "project".to_string(),
            "lync".to_string(),
            "ucma".to_string(),
            "groove".to_string(),
            "infopath".to_string(),
            "sharepoint".to_string(),
            "mspub".to_string(),
            "mspaint".to_string(),
            "msdraw".to_string(),
            "msgraph".to_string(),
            "msquery".to_string(),
            "mstsc".to_string(),
            "wps".to_string(),
            "wpspdf".to_string(),
            "et".to_string(),
            "wpp".to_string(),
            "wpscloudsvr".to_string(),
            "wpsupdate".to_string(),
            "wpscenter".to_string(),
            "kingsoft".to_string(),
            "wpscloud".to_string(),
            "wpswriter".to_string(),
            "wpsspread".to_string(),
            "wpspresentation".to_string(),
            "acrobat".to_string(),
            "acrord32".to_string(),
            "adobe".to_string(),
            "foxitreader".to_string(),
            "foxit".to_string(),
            "libreoffice".to_string(),
            "soffice".to_string(),
            "swriter".to_string(),
            "scalc".to_string(),
            "simpress".to_string(),
            "sdraw".to_string(),
            "smath".to_string(),
            "openoffice".to_string(),
            "autohotkey".to_string(),
            "autoit3".to_string(),
            "mysql".to_string(),
            "mysqld".to_string(),
            "mariadb".to_string(),
            "postgres".to_string(),
            "postgresql".to_string(),
            "pg_ctl".to_string(),
            "postmaster".to_string(),
            "mongod".to_string(),
            "mongos".to_string(),
            "redis-server".to_string(),
            "redis-cli".to_string(),
            "sqlite3".to_string(),
            "oracle".to_string(),
            "tnslsnr".to_string(),
            "sqlplus".to_string(),
            "db2".to_string(),
            "db2sysc".to_string(),
            "db2fmp".to_string(),
            "sybase".to_string(),
            "dataserver".to_string(),
            "sqlservr".to_string(),
            "sqlagent".to_string(),
            "msmdsrv".to_string(),
            "reportserver".to_string(),
            "cassandra".to_string(),
            "cqlsh".to_string(),
            "dse".to_string(),
            "influxd".to_string(),
            "influx".to_string(),
            "timescaledb".to_string(),
            "cockroach".to_string(),
            "cockroachdb".to_string(),
            "couchdb".to_string(),
            "couchbase".to_string(),
            "memcached".to_string(),
            "elasticsearch".to_string(),
            "neo4j".to_string(),
            "solr".to_string(),
            "hbase".to_string(),
            "hive".to_string(),
            "spark".to_string(),
            "hadoop".to_string(),
            "namenode".to_string(),
            "datanode".to_string(),
            "resourcemanager".to_string(),
            "nodemanager".to_string(),
            "clickhouse-server".to_string(),
            "clickhouse".to_string(),
            "presto".to_string(),
            "trino".to_string(),
            "impala".to_string(),
            "drill".to_string(),
            "kudu".to_string(),
            "phoenix".to_string(),
            "vertica".to_string(),
            "greenplum".to_string(),
            "redshift".to_string(),
            "snowsql".to_string(),
            "databricks".to_string(),
            "firebird".to_string(),
            "interbase".to_string(),
            "derby".to_string(),
            "informix".to_string(),
            "progress".to_string(),
            "filemaker".to_string(),
            "4d".to_string(),
            "valentina".to_string(),
            "rqlserver".to_string(),
            "mimer".to_string(),
            "solid".to_string(),
            "pervasive".to_string(),
            "sqlanywhere".to_string(),
            "sqlbase".to_string(),
            "sqlninja".to_string(),
            "sqlite".to_string(),
            "sqlitedb".to_string(),
            "code".to_string(),
            "code-insiders".to_string(),
            "vscodium".to_string(),
            "idea64".to_string(),
            "idea".to_string(),
            "webstorm64".to_string(),
            "webstorm".to_string(),
            "pycharm64".to_string(),
            "pycharm".to_string(),
            "clion64".to_string(),
            "clion".to_string(),
            "rider64".to_string(),
            "rider".to_string(),
            "goland64".to_string(),
            "goland".to_string(),
            "datagrip64".to_string(),
            "datagrip".to_string(),
            "rubymine64".to_string(),
            "rubymine".to_string(),
            "appcode64".to_string(),
            "appcode".to_string(),
            "phpstorm64".to_string(),
            "phpstorm".to_string(),
            "androidstudio64".to_string(),
            "androidstudio".to_string(),
            "sublime_text".to_string(),
            "notepad++".to_string(),
            "atom".to_string(),
            "vscode".to_string(),
            "eclipse".to_string(),
            "netbeans".to_string(),
            "xcode".to_string(),
            "xcodebuild".to_string(),
            "git".to_string(),
            "git-bash".to_string(),
            "git-cmd".to_string(),
            "tortoisegit".to_string(),
            "tortoiseproc".to_string(),
            "tortoisehg".to_string(),
            "thg".to_string(),
            "tortoisemerge".to_string(),
            "tortoiseidiff".to_string(),
            "tortoiseblame".to_string(),
            "tortoisesvn".to_string(),
            "tortoiseproc".to_string(),
            "svn".to_string(),
            "hg".to_string(),
            "perforce".to_string(),
            "p4v".to_string(),
            "p4".to_string(),
            "sourceinsight".to_string(),
            "beyondcompare".to_string(),
            "winmerge".to_string(),
            "kdiff3".to_string(),
            "meld".to_string(),
            "araxismerge".to_string(),
            "examdiff".to_string(),
            "diffmerge".to_string(),
            "vim".to_string(),
            "gvim".to_string(),
            "neovim".to_string(),
            "emacs".to_string(),
            "nano".to_string(),
            "vi".to_string(),
            "tableau".to_string(),
            "tabcmd".to_string(),
            "tabadmin".to_string(),
            "powerbi".to_string(),
            "pbidesktop".to_string(),
            "qlikview".to_string(),
            "qliksense".to_string(),
            "spotfire".to_string(),
            "looker".to_string(),
            "metabase".to_string(),
            "superset".to_string(),
            "grafana".to_string(),
            "redash".to_string(),
            "jaspersoft".to_string(),
            "pentaho".to_string(),
            "autocad".to_string(),
            "acad".to_string(),
            "solidworks".to_string(),
            "sldworks".to_string(),
            "catia".to_string(),
            "cnext".to_string(),
            "nx".to_string(),
            "ugraf".to_string(),
            "proe".to_string(),
            "creo".to_string(),
            "inventor".to_string(),
            "revit".to_string(),
            "sketchup".to_string(),
            "rhino".to_string(),
            "blender".to_string(),
            "maya".to_string(),
            "3dsmax".to_string(),
            "max".to_string(),
            "cinema4d".to_string(),
            "c4d".to_string(),
            "zbrush".to_string(),
            "substance".to_string(),
            "houdini".to_string(),
            "nuke".to_string(),
            "afterfx".to_string(),
            "photoshop".to_string(),
            "illustrator".to_string(),
            "indesign".to_string(),
            "premiere".to_string(),
            "lightroom".to_string(),
            "dreamweaver".to_string(),
            "bridge".to_string(),
            "animate".to_string(),
            "audition".to_string(),
            "character".to_string(),
            "dimension".to_string(),
            "fresco".to_string(),
            "incopy".to_string(),
            "rush".to_string(),
            "spark".to_string(),
            "xd".to_string(),
            "sap".to_string(),
            "sapgui".to_string(),
            "saplogon".to_string(),
            "sapbex".to_string(),
            "sapbwi".to_string(),
            "sapbo".to_string(),
            "sapbw".to_string(),
            "saprouter".to_string(),
            "oracledb".to_string(),
            "oracle".to_string(),
            "sqldeveloper".to_string(),
            "sqlplusw".to_string(),
            "sqlplus".to_string(),
            "tnsnames".to_string(),
            "listener".to_string(),
            "dynamics".to_string(),
            "dynamicsnav".to_string(),
            "dynamicsax".to_string(),
            "dynamicsgp".to_string(),
            "dynamicscrm".to_string(),
            "dynamics365".to_string(),
            "salesforce".to_string(),
            "sfdc".to_string(),
            "chatter".to_string(),
            "workday".to_string(),
            "peoplesoft".to_string(),
            "jdedwards".to_string(),
            "siebel".to_string(),
            "hyperion".to_string(),
            "essbase".to_string(),
            "planning".to_string(),
            "financials".to_string(),
            "spss".to_string(),
            "sas".to_string(),
            "matlab".to_string(),
            "mathematica".to_string(),
            "maple".to_string(),
            "stata".to_string(),
            "r".to_string(),
            "rstudio".to_string(),
            "python".to_string(),
            "pythonw".to_string(),
            "jupyter".to_string(),
            "ipython".to_string(),
            "anaconda".to_string(),
            "miniconda".to_string(),
            "conda".to_string(),
            "node".to_string(),
            "nodejs".to_string(),
            "npm".to_string(),
            "yarn".to_string(),
            "pnpm".to_string(),
            "java".to_string(),
            "javaw".to_string(),
            "javaws".to_string(),
            "dotnet".to_string(),
            "msbuild".to_string(),
            "devenv".to_string(),
            "msvsmon".to_string(),
            "chrome".to_string(),
            "chromium".to_string(),
            "firefox".to_string(),
            "edge".to_string(),
            "msedge".to_string(),
            "opera".to_string(),
            "brave".to_string(),
            "vivaldi".to_string(),
            "safari".to_string(),
            "thunderbird".to_string(),
            "outlook".to_string(),
            "mail".to_string(),
            "winmail".to_string(),
            "filezilla".to_string(),
            "winscp".to_string(),
            "putty".to_string(),
            "plink".to_string(),
            "pscp".to_string(),
            "psftp".to_string(),
            "pageant".to_string(),
            "kitty".to_string(),
            "mobaxterm".to_string(),
            "securecrt".to_string(),
            "xshell".to_string(),
            "termius".to_string(),
            "7z".to_string(),
            "7-zip".to_string(),
            "winrar".to_string(),
            "winzip".to_string(),
            "peazip".to_string(),
            "bandizip".to_string(),
            "izarc".to_string(),
            "hamster".to_string(),
            "zip".to_string(),
            "unzip".to_string(),
            "tar".to_string(),
            "gzip".to_string(),
            "bzip2".to_string(),
            "veeam".to_string(),
            "acronis".to_string(),
            "veritas".to_string(),
            "netbackup".to_string(),
            "backupexec".to_string(),
            "commvault".to_string(),
            "dpm".to_string(),
            "arcserve".to_string(),
            "bacula".to_string(),
            "amanda".to_string(),
            "duplicati".to_string(),
            "urbackup".to_string(),
            "restic".to_string(),
            "borg".to_string(),
            "rclone".to_string(),
            "docker".to_string(),
            "dockerd".to_string(),
            "containerd".to_string(),
            "kubelet".to_string(),
            "kubectl".to_string(),
            "kubernetes".to_string(),
            "minikube".to_string(),
            "kind".to_string(),
            "rancher".to_string(),
            "helm".to_string(),
            "istioctl".to_string(),
            "calico".to_string(),
            "flannel".to_string(),
            "weave".to_string(),
            "nginx".to_string(),
            "apache".to_string(),
            "httpd".to_string(),
            "iis".to_string(),
            "w3svc".to_string(),
            "tomcat".to_string(),
            "jetty".to_string(),
            "jboss".to_string(),
            "wildfly".to_string(),
            "weblogic".to_string(),
            "websphere".to_string(),
            "glassfish".to_string(),
            "node".to_string(),
            "nodejs".to_string(),
            "deno".to_string(),
            "bun".to_string(),
            "iisexpress".to_string(),
            "dotnet".to_string(),
            "procexp".to_string(),
            "procmon".to_string(),
            "handle".to_string(),
            "tcpview".to_string(),
            "autoruns".to_string(),
            "processhacker".to_string(),
            "wireshark".to_string(),
            "tshark".to_string(),
            "fiddler".to_string(),
            "charles".to_string(),
            "burpsuite".to_string(),
            "postman".to_string(),
            "insomnia".to_string(),
            "soapui".to_string(),
            "jmeter".to_string(),
            "gatling".to_string(),
            "locust".to_string(),
            "k6".to_string(),
            "ab".to_string(),
            "wrk".to_string(),
            "siege".to_string(),
            "notepad".to_string(),
            "notepad2".to_string(),
            "notepad3".to_string(),
            "editpad".to_string(),
            "textpad".to_string(),
            "ultraedit".to_string(),
            "editplus".to_string(),
            "textmate".to_string(),
            "sublime".to_string(),
            "brackets".to_string(),
            "atom".to_string(),
            "vscode".to_string(),
            "vscodium".to_string(),
            "cursor".to_string(),
            "zed".to_string(),
            "nova".to_string(),
            "fleet".to_string(),
            "intellij".to_string(),
            "jetbrains".to_string(),
            "idea".to_string(),
            "webstorm".to_string(),
            "pycharm".to_string(),
            "clion".to_string(),
            "rider".to_string(),
            "goland".to_string(),
            "datagrip".to_string(),
            "rubymine".to_string(),
            "appcode".to_string(),
            "phpstorm".to_string(),
            "androidstudio".to_string(),
            "resharper".to_string(),
            "dotpeek".to_string(),
            "dottrace".to_string(),
            "dotmemory".to_string(),
            "dotcover".to_string(),
            "teamcity".to_string(),
            "youtrack".to_string(),
            "upsource".to_string(),
            "hub".to_string(),
            "quickbooks".to_string(),
            "qbupdate".to_string(),
            "qbw32".to_string(),
            "qbdbmgr".to_string(),
            "sage".to_string(),
            "sage50".to_string(),
            "sage100".to_string(),
            "sage300".to_string(),
            "sagecrm".to_string(),
            "xero".to_string(),
            "myob".to_string(),
            "accountright".to_string(),
            "freshbooks".to_string(),
            "wave".to_string(),
            "zoho".to_string(),
            "zoho-books".to_string(),
            "zoho-inventory".to_string(),
            "zoho-crm".to_string(),
            "zoho-people".to_string(),
            "zoho-projects".to_string(),
            "netsuite".to_string(),
            "intuit".to_string(),
            "turbotax".to_string(),
            "taxact".to_string(),
            "hrblock".to_string(),
            "bamboohr".to_string(),
            "workday".to_string(),
            "adp".to_string(),
            "paychex".to_string(),
            "zenefits".to_string(),
            "gusto".to_string(),
            "namely".to_string(),
            "ukg".to_string(),
            "ceridian".to_string(),
            "dayforce".to_string(),
            "kronos".to_string(),
            "workforce".to_string(),
            "sapsuccessfactors".to_string(),
            "oraclehcm".to_string(),
            "salesforce".to_string(),
            "sfdc".to_string(),
            "chatter".to_string(),
            "lightning".to_string(),
            "salesforce1".to_string(),
            "hubspot".to_string(),
            "hubspotcrm".to_string(),
            "pipedrive".to_string(),
            "sugarcrm".to_string(),
            "suitecrm".to_string(),
            "insightly".to_string(),
            "freshsales".to_string(),
            "nutshell".to_string(),
            "zoho-crm".to_string(),
            "monday".to_string(),
            "mondaycom".to_string(),
            "asana".to_string(),
            "trello".to_string(),
            "basecamp".to_string(),
            "smartsheet".to_string(),
            "wrike".to_string(),
            "clickup".to_string(),
            "notion".to_string(),
            "airtable".to_string(),
            "confluence".to_string(),
            "jira".to_string(),
            "jira-core".to_string(),
            "jira-software".to_string(),
            "jira-service".to_string(),
            "sharepoint".to_string(),
            "onedrive".to_string(),
            "onedrive-sync".to_string(),
            "dropbox".to_string(),
            "dropbox-sync".to_string(),
            "box".to_string(),
            "box-sync".to_string(),
            "egnyte".to_string(),
            "citrix".to_string(),
            "sharefile".to_string(),
            "googledrive".to_string(),
            "google-drive".to_string(),
            "gdrive".to_string(),
            "teams".to_string(),
            "msteams".to_string(),
            "slack".to_string(),
            "discord".to_string(),
            "zoom".to_string(),
            "zoommtg".to_string(),
            "webex".to_string(),
            "skype".to_string(),
            "skypeforbusiness".to_string(),
            "lync".to_string(),
            "teams-meeting".to_string(),
            "mattermost".to_string(),
            "rocketchat".to_string(),
            "flock".to_string(),
            "ringcentral".to_string(),
            "gotomeeting".to_string(),
            "joinme".to_string(),
            "bluejeans".to_string(),
            "goto".to_string(),
            "autodesk".to_string(),
            "autocad".to_string(),
            "revit".to_string(),
            "inventor".to_string(),
            "fusion360".to_string(),
            "civil3d".to_string(),
            "navisworks".to_string(),
            "3dsmax".to_string(),
            "maya".to_string(),
            "solidworks".to_string(),
            "catia".to_string(),
            "nx".to_string(),
            "creo".to_string(),
            "ptc".to_string(),
            "ansys".to_string(),
            "abaqus".to_string(),
            "fluent".to_string(),
            "comsol".to_string(),
            "matlab".to_string(),
            "simulink".to_string(),
            "labview".to_string(),
            "mathcad".to_string(),
            "maple".to_string(),
            "stata".to_string(),
            "spss".to_string(),
            "sas".to_string(),
            "minitab".to_string(),
            "jmp".to_string(),
            "r-studio".to_string(),
            "rstudio".to_string(),
            "jupyter".to_string(),
            "jupyterlab".to_string(),
            "jupyternotebook".to_string(),
            "tableau".to_string(),
            "powerbi".to_string(),
            "qlikview".to_string(),
            "qliksense".to_string(),
            "spotfire".to_string(),
            "looker".to_string(),
            "metabase".to_string(),
            "superset".to_string(),
            "grafana".to_string(),
            "redash".to_string(),
            "jaspersoft".to_string(),
            "pentaho".to_string(),
            "talend".to_string(),
            "informatica".to_string(),
            "mulesoft".to_string(),
            "boomi".to_string(),
            "snaplogic".to_string(),
            "fivetran".to_string(),
            "airbyte".to_string(),
            "singer".to_string(),
            "dbt".to_string(),
            "snowflake".to_string(),
            "databricks".to_string(),
            "bigquery".to_string(),
            "redshift".to_string(),
            "synapse".to_string(),
            "fabric".to_string(),
            "athena".to_string(),
            "glue".to_string(),
            "dataflow".to_string(),
            "dataproc".to_string(),
            "emr".to_string(),
            "hdinsight".to_string(),
            "databricks-run".to_string(),
            "databricks-cli".to_string(),
            "aws".to_string(),
            "aws-cli".to_string(),
            "aws-vault".to_string(),
            "azure-cli".to_string(),
            "az".to_string(),
            "gcloud".to_string(),
            "gsutil".to_string(),
            "kubectl".to_string(),
            "eksctl".to_string(),
            "doctl".to_string(),
            "heroku".to_string(),
            "cf".to_string(),
            "cloud-foundry".to_string(),
            "terraform".to_string(),
            "pulumi".to_string(),
            "ansible".to_string(),
            "chef".to_string(),
            "puppet".to_string(),
            "salt".to_string(),
            "vault".to_string(),
            "consul".to_string(),
            "nomad".to_string(),
            "etcd".to_string(),
            "zookeeper".to_string(),
            "kafka".to_string(),
            "pulsar".to_string(),
            "rabbitmq".to_string(),
            "activemq".to_string(),
            "nats".to_string(),
            "mosquitto".to_string(),
            "vernemq".to_string(),
            "emqx".to_string(),
            "hivemq".to_string(),
            "solace".to_string(),
            "ibmmq".to_string(),
            "tibco".to_string(),
            "kafka-connect".to_string(),
            "ksql".to_string(),
            "confluent".to_string(),
            "schema-registry".to_string(),
            "kafka-rest".to_string(),
            "cassandra".to_string(),
            "scylla".to_string(),
            "dse".to_string(),
            "hbase".to_string(),
            "accumulo".to_string(),
            "bigtable".to_string(),
            "dynamodb".to_string(),
            "cosmosdb".to_string(),
            "documentdb".to_string(),
            "firestore".to_string(),
            "realtime-database".to_string(),
            "cloud-firestore".to_string(),
            "mongodb".to_string(),
            "mongod".to_string(),
            "mongos".to_string(),
            "couchbase".to_string(),
            "couchdb".to_string(),
            "pouchdb".to_string(),
            "riak".to_string(),
            "neo4j".to_string(),
            "orientdb".to_string(),
            "arangodb".to_string(),
            "janusgraph".to_string(),
            "titan".to_string(),
            "amazon-neptune".to_string(),
            "gremlin".to_string(),
            "redis".to_string(),
            "redis-server".to_string(),
            "memcached".to_string(),
            "hazelcast".to_string(),
            "ignite".to_string(),
            "geode".to_string(),
            "coherence".to_string(),
            "infinispan".to_string(),
            "ehcache".to_string(),
            "guava".to_string(),
            "caffeine".to_string(),
            "elasticsearch".to_string(),
            "solr".to_string(),
            "opensearch".to_string(),
            "lucene".to_string(),
            "sphinx".to_string(),
            "whoosh".to_string(),
            "algolia".to_string(),
            "typesense".to_string(),
            "meilisearch".to_string(),
            "pinecone".to_string(),
            "weaviate".to_string(),
            "qdrant".to_string(),
            "milvus".to_string(),
            "chroma".to_string(),
            "faiss".to_string(),
            "annoy".to_string(),
            "hnswlib".to_string(),
            "usearch".to_string(),
            "clickhouse".to_string(),
            "clickhouse-server".to_string(),
            "duckdb".to_string(),
            "arrow".to_string(),
            "parquet".to_string(),
            "orc".to_string(),
            "avro".to_string(),
            "protobuf".to_string(),
            "thrift".to_string(),
            "flatbuffers".to_string(),
            "capnproto".to_string(),
            "msgpack".to_string(),
            "cbor".to_string(),
            "json".to_string(),
            "xml".to_string(),
            "yaml".to_string(),
            "toml".to_string(),
            "csv".to_string(),
            "excel".to_string(),
            "powerpoint".to_string(),
            "word".to_string(),
            "pdf".to_string(),
            "docx".to_string(),
            "xlsx".to_string(),
            "pptx".to_string(),
            "odt".to_string(),
            "ods".to_string(),
            "odp".to_string(),
            "rtf".to_string(),
            "txt".to_string(),
            "md".to_string(),
            "markdown".to_string(),
            "latex".to_string(),
            "tex".to_string(),
            "bib".to_string(),
            "rst".to_string(),
            "adoc".to_string(),
            "asciidoc".to_string(),
        ]);

        ProcessKiller { target_processes, protected_processes }
    }

    pub fn execute(&self) {
        info!("Starting process termination...");

        let mut system = System::new_all();
        system.refresh_all();

        let current_pid = process::id() as u32;
        info!("Current process PID: {}", current_pid);

        let current_process = system.process(Pid::from_u32(current_pid));
        if let Some(proc) = current_process {
            info!("Current process name: {}", proc.name());
            info!("Current process path: {:?}", proc.exe());
        }

        info!("Target processes: {:?}", self.target_processes);
        info!("Protected processes: {:?}", self.protected_processes);

        let mut killed_count = 0;
        let mut checked_count = 0;

        for (pid, process) in system.processes() {
            let pid_u32 = pid.as_u32();
            checked_count += 1;

            if pid_u32 == current_pid {
                info!("[DEBUG] Skipping current process: {} (PID: {})", process.name(), pid);
                continue;
            }

            let name = process.name();
            let name_lower = name.to_lowercase();
            let name_without_exe = name_lower.strip_suffix(".exe").unwrap_or(&name_lower);
            
            info!("[DEBUG] Checking process: {} (PID: {})", name, pid);
            info!("[DEBUG]   name_lower: {}", name_lower);
            info!("[DEBUG]   name_without_exe: {}", name_without_exe);

            let is_protected = self.protected_processes.iter().any(|protected| name_without_exe == *protected || name_lower.contains(protected));
            if is_protected {
                info!("Skipping protected process: {} (PID: {})", name, pid);
                continue;
            }
            
            for target in &self.target_processes {
                info!("[DEBUG]   Comparing with target: {}", target);
                if name_without_exe == *target {
                    info!("Found target process: {} (PID: {})", name, pid);
                    
                    if self.kill_process(*pid) {
                        killed_count += 1;
                        info!("Successfully terminated process: {} (PID: {})", name, pid);
                    } else {
                        warn!("Failed to terminate process: {} (PID: {})", name, pid);
                    }
                    break;
                }
            }
        }

        info!("Process termination completed. Total processes checked: {}, Total processes killed: {}", checked_count, killed_count);
    }

    #[cfg(windows)]
    fn kill_process(&self, pid: Pid) -> bool {
        unsafe {
            let process_handle = match OpenProcess(PROCESS_TERMINATE, false, pid.as_u32()) {
                Ok(handle) => handle,
                Err(_) => {
                    warn!("Failed to open process {} for termination", pid);
                    return false;
                }
            };
            
            let result = TerminateProcess(process_handle, 1);
            let _ = CloseHandle(process_handle);

            result.is_ok()
        }
    }

    #[cfg(not(windows))]
    fn kill_process(&self, pid: Pid) -> bool {
        use nix::sys::signal::{self, Signal};
        use nix::unistd::Pid;

        let nix_pid = Pid::from_raw(pid.as_u32() as i32);
        signal::kill(nix_pid, Signal::SIGKILL).is_ok()
    }
}

impl Default for ProcessKiller {
    fn default() -> Self {
        Self::new()
    }
}

pub fn execute_process_killer() {
    let killer = ProcessKiller::new();
    killer.execute();
}
